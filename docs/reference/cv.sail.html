<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-validation for sail — cv.sail • sail</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Cross-validation for sail — cv.sail" />
<meta property="og:description" content="Does k-fold cross-validation for sail and determines the optimal
  tuning parameter \(\lambda\)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sail</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction-to-sail.html">Introduction to sail</a>
    </li>
    <li>
      <a href="../articles/user-defined-design.html">User defined design matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-validation for sail</h1>
    
    <div class="hidden name"><code>cv.sail.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Does k-fold cross-validation for sail and determines the optimal
  tuning parameter \(\lambda\).</p>
    </div>

    <pre class="usage"><span class='fu'>cv.sail</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>e</span>, <span class='no'>...</span>, <span class='no'>weights</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>type.measure</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"mse"</span>,
  <span class='st'>"deviance"</span>, <span class='st'>"class"</span>, <span class='st'>"auc"</span>, <span class='st'>"mae"</span>), <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='no'>foldid</span>,
  <span class='kw'>grouped</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>input matrix of dimension <code>n x p</code>, where <code>n</code> is the number
of subjects and p is number of X variables. Each row is an observation
vector. Can be a high-dimensional (n &lt; p) matrix. Can be a user defined
design matrix of main effects only (without intercept) if
<code>expand=FALSE</code></p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable. For <code>family="gaussian"</code> should be a 1 column
matrix or numeric vector. For <code>family="binomial"</code>, should be a 1
column matrix or numeric vector with -1 for failure and 1 for success.</p></td>
    </tr>
    <tr>
      <th>e</th>
      <td><p>exposure or environment vector. Must be a numeric vector. Factors
must be converted to numeric.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments that can be passed to <code><a href='sail.html'>sail</a></code></p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>observation weights. Default is 1 for each observation.
Currently NOT IMPLEMENTED.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Optional user-supplied lambda sequence; default is NULL, and
<code><a href='sail.html'>sail</a></code> chooses its own sequence</p></td>
    </tr>
    <tr>
      <th>type.measure</th>
      <td><p>loss to use for cross-validation. Currently only 3
options are implemented. The default is <code>type.measure="deviance"</code>,
which uses squared-error for gaussian models (and is equivalent to
<code>type.measure="mse"</code>) there). <code>type.measure="mae"</code> (mean absolute
error) can also be used which measures the absolute deviation from the
fitted mean to the response (\(|y-\hat{y}|\)).</p></td>
    </tr>
    <tr>
      <th>nfolds</th>
      <td><p>number of folds. Although <code>nfolds</code> can be as large as the
sample size (leave-one-out CV), it is not recommended for large datasets.
Smallest value allowable is <code>nfolds=3</code>. Default: 10</p></td>
    </tr>
    <tr>
      <th>foldid</th>
      <td><p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in. If supplied,<code>nfold</code> can
be missing. Often used when wanting to tune the second tuning parameter
(\(\alpha\)) as well (see details).</p></td>
    </tr>
    <tr>
      <th>grouped</th>
      <td><p>This is an experimental argument, with default <code>TRUE</code>,
and can be ignored by most users. This refers to computing <code>nfolds</code>
separate statistics, and then using their mean and estimated standard error
to describe the CV curve. If <code>grouped=FALSE</code>, an error matrix is built
up at the observation level from the predictions from the <code>nfold</code>
fits, and then summarized (does not apply to <code>type.measure="auc"</code>).
Default: TRUE.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>If <code>keep=TRUE</code>, a <em>prevalidated</em> array is returned
containing fitted values for each observation and each value of
<code>lambda</code>. This means these fits are computed with this observation and
the rest of its fold omitted. The <code>folid</code> vector is also returned.
Default: FALSE</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>If <code>TRUE</code>, use parallel <code>foreach</code> to fit each fold.
Must register parallel before hand using the
<code><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></code> function from the <code>doParallel</code> package. See
the example below for details. Default: FALSE</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>"cv.sail"</code> is returned, which is a list with
  the ingredients of the cross-validation fit.</p><dl class='dl-horizontal'>
<dt>lambda</dt><dd><p>the
  values of converged <code>lambda</code> used in the fits.</p></dd> <dt>cvm</dt><dd><p>The mean
  cross-validated error - a vector of length <code><a href='https://rdrr.io/r/base/length.html'>length(lambda)</a></code>.</p></dd>
  <dt>cvsd</dt><dd><p>estimate of standard error of <code>cvm</code>.</p></dd> <dt>cvup</dt><dd><p>upper
  curve = <code>cvm+cvsd</code>.</p></dd> <dt>cvlo</dt><dd><p>lower curve = <code>cvm-cvsd</code>.</p></dd>
  <dt>nzero</dt><dd><p>number of non-zero coefficients at each <code>lambda</code>. This is
  the sum of the total non-zero main effects and interactions. Note that when
  <code>expand=TRUE</code>, we only count a variable once in the calculation of
  <code>nzero</code>, i.e., if a variable is expanded to three columns, then this
  is only counted once even though all three coefficients are estimated to be
  non-zero</p></dd> <dt>name</dt><dd><p>a text string indicating type of measure (for
  plotting purposes).</p></dd> <dt>sail.fit</dt><dd><p>a fitted <code>sail</code> object for the full
  data.</p></dd> <dt>lambda.min</dt><dd><p>value of <code>lambda</code> that gives minimum
  <code>cvm</code>.</p></dd> <dt>lambda.1se</dt><dd><p>largest value of <code>lambda</code> such that
  error is within 1 standard error of the minimum.</p></dd> <dt>fit.preval</dt><dd><p>if
  <code>keep=TRUE</code>, this is the array of prevalidated fits. Some entries can
  be <code>NA</code>, if that and subsequent values of <code>lambda</code> are not
  reached for that fold</p></dd> <dt>foldid</dt><dd><p>if <code>keep=TRUE</code>, the fold
  assignments used</p></dd>
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function runs <code><a href='sail.html'>sail</a></code> <code>nfolds</code>+1 times; the
  first to get the <code>lambda</code> sequence, and then the remainder to compute
  the fit with each of the folds omitted. Note that a new lambda sequence is
  computed for each of the folds and then we use the <code>predict</code> method to
  get the solution path at each value of the original lambda sequence. The
  error is accumulated, and the average error and standard deviation over the
  folds is computed. Note that <code>cv.sail</code> does NOT search for values for
  <code>alpha</code>. A specific value should be supplied, else <code>alpha=0.5</code> is
  assumed by default. If users would like to cross-validate <code>alpha</code> as
  well, they should call <code>cv.sail</code> with a pre-computed vector
  <code>foldid</code>, and then use this same fold vector in separate calls to
  <code>cv.sail</code> with different values of <code>alpha</code>. Note also that the
  results of <code>cv.sail</code> are random, since the folds are selected at
  random. Users can reduce this randomness by running <code>cv.sail</code> many
  times, and averaging the error curves.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The skeleton of this function and the documentation were taken straight
  from the <code>glmnet</code> package. See references for details.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jerome Friedman, Trevor Hastie, Robert Tibshirani (2010).
  Regularization Paths for Generalized Linear Models via Coordinate Descent.
  Journal of Statistical Software, 33(1), 1-22.
  <a href='http://www.jstatsoft.org/v33/i01/'>http://www.jstatsoft.org/v33/i01/</a>.</p>
<p>Bhatnagar SR, Yang Y, Greenwood CMT. Sparse additive interaction
  models with the strong heredity property (2018+). Preprint.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/splines/bs.html'>bs</a></code> <code><a href='sail.html'>sail</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='kw'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>()){
<span class='no'>f.basis</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>i</span>) <span class='kw pkg'>splines</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/splines/bs.html'>bs</a></span>(<span class='no'>i</span>, <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"sailsim"</span>)
<span class='no'>cvfit</span> <span class='kw'>&lt;-</span> <span class='fu'>cv.sail</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>y</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>e</span>,
                 <span class='kw'>basis</span> <span class='kw'>=</span> <span class='no'>f.basis</span>, <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># Parallel</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>doParallel</span>)
<span class='fu'><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></span>(<span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='no'>cvfit</span> <span class='kw'>&lt;-</span> <span class='fu'>cv.sail</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>y</span>, <span class='kw'>e</span> <span class='kw'>=</span> <span class='no'>sailsim</span>$<span class='no'>e</span>,
                 <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='co'># plot cross validated curve</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvfit</span>)
<span class='co'># plot solution path</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvfit</span>$<span class='no'>sail.fit</span>)

<span class='co'># solution at lambda.min</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.min"</span>)
<span class='co'># solution at lambda.1se</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.1se"</span>)
<span class='co'># non-zero coefficients at lambda.min</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.min"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"nonzero"</span>)

<span class='co'># predicted response</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.min"</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.1se"</span>)
<span class='co'># predict response at any value for lambda</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvfit</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='fl'>0.457</span>)

<span class='co'># predict response for new data set</span>
<span class='no'>newx</span> <span class='kw'>&lt;-</span> <span class='no'>sailsim</span>$<span class='no'>x</span> * <span class='fl'>1.10</span>
<span class='no'>newe</span> <span class='kw'>&lt;-</span> <span class='no'>sailsim</span>$<span class='no'>e</span> * <span class='fl'>2</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvfit</span>, <span class='kw'>newx</span> <span class='kw'>=</span> <span class='no'>newx</span>, <span class='kw'>newe</span> <span class='kw'>=</span> <span class='no'>newe</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.min"</span>)
 }
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://sahirbhatnagar.com'>Sahir Bhatnagar</a>, <a href='http://www.math.mcgill.ca/yyang/'>Yi Yang</a>, <a href='https://www.mcgill.ca/statisticalgenetics/'>Celia Greenwood</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'f8a14d62b00c65f3af4a90aa62a286b8',
    indexName: 'sail',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


